<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cedars Ranch Wedding Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color-scheme: light;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f5f7f4;
      color: #243024;
    }

    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
    }

    h1 {
      margin: 0 0 4px;
      font-size: 1.8rem;
    }

    .subtitle {
      margin: 0 0 16px;
      color: #5b6b5c;
      font-size: 0.95rem;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
      gap: 18px;
      align-items: start;
    }

    @media (max-width: 800px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .map-wrapper {
      position: relative;
      background: white;
      border-radius: 12px;
      padding: 10px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.06);
    }

    .map-image {
      display: block;
      width: 100%;
      height: auto;
      border-radius: 10px;
    }

    /* Invisible clickable hotspot */
    .hotspot {
      position: absolute;
      width: 4%;
      height: 4%;
      transform: translate(-50%, -50%);
      padding: 0;
      margin: 0;
      background: transparent;
      border-radius: 999px;
      cursor: pointer;
      border: 2px solid transparent;
      z-index: 5;
    }

    /* Cabin shape — rounded rectangle */
    .hotspot[data-type="Cabin"] {
      border-radius: 20%;
      width: 4.8%;
      height: 3.6%;
    }

    /* Geodome shape — round */
    .hotspot[data-type="Geodome"] {
      border-radius: 999px;
      width: 4%;
      height: 4%;
    }

    /* Yurt — oval */
    .hotspot[data-type="Yurt"] {
      border-radius: 60%;
      width: 4.6%;
      height: 3.8%;
    }

    .hotspot:hover {
      background: transparent;
    }

    .hotspot.active-hotspot {
      z-index: 6;
      position: absolute;
    }

    .hotspot.active-hotspot::before {
      content: "";
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 260%;
      height: 220%;
      border: 3px solid #D87465;
      background: rgba(255, 255, 255, 0.22);
      box-shadow:
        0 0 25px rgba(0, 0, 0, 0.35),
        0 0 0 3px rgba(255, 255, 255, 0.85);
      border-radius: 18px;
      pointer-events: none;
      z-index: 7;
    }

    .hotspot[data-type="Cabin"].active-hotspot::before {
      width: 250%;
      height: 220%;
      border-radius: 25px;
    }

    .hotspot[data-type="Geodome"].active-hotspot::before {
      width: 220%;
      height: 220%;
      border-radius: 999px;
    }

    .hotspot[data-type="Yurt"].active-hotspot::before {
      width: 250%;
      height: 250%;
      border-radius: 45%;
    }

    .hotspot-label {
      position: absolute;
      transform: translate(-50%, -50%);
      font-size: 0.65rem;
      font-weight: 600;
      color: #1f2b1f;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.9);
      pointer-events: none;
      white-space: nowrap;
    }

    /* ==== Right-side panel & guest list ==== */

    .panel {
      background: white;
      border-radius: 12px;
      padding: 12px 12px 8px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.06);
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 640px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 4px;
    }

    .panel-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .panel-subtitle {
      font-size: 0.8rem;
      color: #6b7a6c;
    }
/* Close button inside the guest panel */
.panel-close {
  display: none;              /* only show on mobile via media query */
  border: none;
  background: transparent;
  font-size: 1.4rem;
  line-height: 1;
  cursor: pointer;
  color: #6b7a6c;
  padding: 2px 4px;
}

/* On mobile, show the close button in the header */
@media (max-width: 800px) {
  .panel-close {
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
}

    .cabins-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 4px;
      overflow-y: auto;
      padding-right: 2px;
      max-height: 230px;
    }

    .cabin-item button {
      width: 100%;
      border: none;
      text-align: left;
      padding: 6px 8px;
      border-radius: 8px;
      background: #f3f6f2;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      transition: background 0.15s ease, transform 0.05s ease;
      font-size: 0.9rem;
    }

    .cabin-item button:hover {
      background: #e6efe3;
      transform: translateY(-1px);
    }

    .cabin-item button.active {
      background: #ccdcca;
      font-weight: 600;
    }

    .cabin-name {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .cabin-status {
      font-size: 0.7rem;
      color: #5f6d60;
      margin-left: 8px;
      flex-shrink: 0;
    }

    .details {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 10px;
      background: #f7faf6;
      border: 1px solid #e0ebde;
      font-size: 0.9rem;
    }

    .details-title {
      font-size: 0.8rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #7b897b;
      margin-bottom: 4px;
    }

    .guest-names {
      font-weight: 600;
      color: #2e3b2f;
      line-height: 1.5;
    }

    .empty {
      font-style: italic;
      color: #8a9b8b;
      font-weight: 400;
    }

    .legend {
      margin-top: 8px;
      font-size: 0.78rem;
      color: #6b7a6c;
    }

    .panel-toggle {
      display: none;
    }

    .panel-backdrop {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.25);
      z-index: 10;
    }

    .guest-photo-wrapper {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .guest-photo {
      width: 72px;
      height: 72px;
      border-radius: 999px;
      object-fit: cover;
      border: 2px solid #d4e0d2;
      background: #e8efe7;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.18);
      cursor: zoom-in;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .guest-photo:hover {
      transform: scale(1.04);
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.22);
    }

    /* Mobile drawer behavior */
    @media (max-width: 800px) {
      .panel-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 8px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid #d2ded0;
        background: #f7faf6;
        cursor: pointer;
        font-size: 0.85rem;
      }

      .layout {
        grid-template-columns: 1fr;
      }

      .panel {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        width: min(420px, 92%); /* leave ~8% of map visible on the left */
        max-width: 100%;
        transform: translateX(100%);
        transition: transform 0.25s ease;
        z-index: 20;
        border-radius: 16px 0 0 16px;
      }

      .panel.panel-open {
        transform: translateX(0);
      }

      .panel-backdrop {
        display: block;
      }
    }

    /* ===== Photo lightbox overlay ===== */

    .photo-lightbox {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .photo-lightbox.open {
      display: flex;
    }

    .photo-lightbox-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(2px);
      opacity: 0;
      transition: opacity 180ms ease-in;
    }

    .photo-lightbox.open .photo-lightbox-backdrop {
      opacity: 1;
    }

    .photo-lightbox-content {
      position: relative;
      z-index: 2;
      background: #fafdf8;
      padding: 14px;
      border-radius: 14px;
      max-width: 90vw;
      max-height: 90vh;
      box-shadow: 0 15px 40px rgba(0,0,0,0.35);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .photo-lightbox-image {
      max-width: 100%;
      max-height: 70vh;
      border-radius: 10px;
      object-fit: contain;
      opacity: 0;
      transition: opacity 180ms ease-in;
    }

    .photo-lightbox.open .photo-lightbox-image {
      opacity: 1;
    }

    .photo-lightbox-caption {
      margin-top: 10px;
      font-size: 0.9rem;
      color: #2e3b2f;
    }

    .photo-lightbox-close {
      position: absolute;
      top: 6px;
      right: 10px;
      font-size: 1.8rem;
      line-height: 1;
      border: none;
      background: transparent;
      cursor: pointer;
      z-index: 3;
      color: #2e3b2f;
    }
  </style>
</head>
<body>
  <main class="page">
    <h1>The Cedars Ranch – Wedding Lodging Map</h1>
    <p class="subtitle">
      Tap a cabin or geodome on the map (or in the list) to see who’s staying there.
      <button class="panel-toggle" id="panelToggle">Guest list ▾</button>
    </p>

    <section class="layout">
      <div class="map-wrapper">
        <img id="mapImage" class="map-image" src="cedars-map.png" alt="Map of The Cedars Ranch property" />

        <!-- Hotspots -->
        <button class="hotspot" data-cabin="Prickly Pear" data-type="Cabin" style="left: 23.2%; top: 89.3%;"></button>
        <button class="hotspot" data-cabin="Luckenbach" data-type="Geodome" style="left: 16%; top: 84%;"></button>
        <button class="hotspot" data-cabin="Live Oak" data-type="Cabin" style="left: 15%; top: 74.3%;"></button>
        <button class="hotspot" data-cabin="Shiner" data-type="Geodome" style="left: 13.5%; top: 66.6%;"></button>
        <button class="hotspot" data-cabin="Red Bud" data-type="Cabin" style="left: 13%; top: 55%;"></button>
        <button class="hotspot" data-cabin="Lockhart" data-type="Geodome" style="left: 23%; top: 54.4%;"></button>
        <button class="hotspot" data-cabin="Marfa" data-type="Geodome" style="left: 14%; top: 47.4%;"></button>
        <button class="hotspot" data-cabin="Winecup" data-type="Cabin" style="left: 22.9%; top: 40.5%;"></button>
        <button class="hotspot" data-cabin="Mesquite" data-type="Cabin" style="left: 10.4%; top: 35.5%;"></button>
        <button class="hotspot" data-cabin="Bandera" data-type="Geodome" style="left: 28%; top: 45.9%;"></button>
        <button class="hotspot" data-cabin="Pecan" data-type="Cabin" style="left: 35.1%; top: 26.9%;"></button>
        <button class="hotspot" data-cabin="Boerne" data-type="Geodome" style="left: 24%; top: 29%;"></button>
        <button class="hotspot" data-cabin="Amarillo" data-type="Geodome" style="left: 20.5%; top: 15%;"></button>
        <button class="hotspot" data-cabin="Cypress" data-type="Cabin" style="left: 7.6%; top: 23%;"></button>
        <button class="hotspot" data-cabin="Bluebonnet" data-type="Cabin" style="left: 7.8%; top: 15%;"></button>
        <button class="hotspot" data-cabin="Primrose" data-type="Cabin" style="left: 26.3%; top: 13.4%;"></button>
        <button class="hotspot" data-cabin="Lufkin" data-type="Geodome" style="left: 36.2%; top: 14.4%;"></button>
        <button class="hotspot" data-cabin="Beaumont" data-type="Geodome" style="left: 41.4%; top: 24.7%;"></button>
        <button class="hotspot" data-cabin="Gruene" data-type="Geodome" style="left: 43.4%; top: 13.7%;"></button>
        <button class="hotspot" data-cabin="Jefferson" data-type="Geodome" style="left: 56%; top: 34.6%;"></button>
        <button class="hotspot" data-cabin="Texas Lantana" data-type="Cabin" style="left: 49.2%; top: 18.2%;"></button>
        <button class="hotspot" data-cabin="Eco Yurt" data-type="Yurt" style="left: 58.6%; top: 18%;"></button>
        <button class="hotspot" data-cabin="Wimberley" data-type="Geodome" style="left: 75.7%; top: 38.4%;"></button>
      </div>

      <aside class="panel" aria-label="Cabin guest list">
        <div>
          <div class="panel-header">
  <div>
    <div class="panel-title" id="selected-cabin-name">Select a guest</div>
    <div class="panel-subtitle" id="selected-cabin-type"></div>
  </div>

  <!-- New mobile close button -->
  <button
    type="button"
    id="panelClose"
    class="panel-close"
    aria-label="Close guest list"
  >
    ×
  </button>
</div>

          <div class="details" id="details-box">
            <div class="details-title">Staying in</div>
            <div class="guest-names empty">
              Click a guest or cabin to see where they're staying.
            </div>
            <div id="guest-photo-wrapper" class="guest-photo-wrapper"></div>
          </div>
        </div>

        <ul class="cabins-list" id="cabins-list">
          <!-- Populated by JavaScript -->
        </ul>

        <div class="legend">
          <strong>Note:</strong> Only guests with assigned lodging are listed here.
        </div>
      </aside>
    </section>

    <div class="panel-backdrop" id="panelBackdrop"></div>

    <!-- Photo lightbox / zoom overlay -->
    <div id="photoLightbox" class="photo-lightbox" aria-hidden="true">
      <div class="photo-lightbox-backdrop"></div>
      <div class="photo-lightbox-content" role="dialog" aria-modal="true">
        <button class="photo-lightbox-close" type="button" aria-label="Close photo">
          ×
        </button>
        <img id="lightboxImage" class="photo-lightbox-image" alt="" loading="lazy" />
        <div id="lightboxCaption" class="photo-lightbox-caption"></div>
      </div>
    </div>
  </main>

  <script>
  const cabins = [
    {
      number: 1,
      name: "Prickly Pear",
      type: "Cabin",
      guests: [
        { name: "Sage and Sam Castillo", photo: "photos/sage-sam.png" },
      ]
    },
    {
      number: 2,
      name: "Luckenbach",
      type: "Geodome",
      guests: [
        { name: "Cameron Marsden", photo: "photos/cameronm.jpg" },
        { name: "Rachel Wynder", photo: "photos/rachelw.jpg" },
      ]
    },
    {
      number: 3,
      name: "Live Oak",
      type: "Cabin",
      guests: [
        { name: "Beth Ann and Scott Matlock", photo: "photos/bethann-scott.png" },
        { name: "Tyler Matlock and Leah Spanhel", photo: "photos/tyler-leah.png" },
        { name: "Kelly Matlock", photo: "photos/kelly.png" },
      ]
    },
    {
      number: 4,
      name: "Shiner",
      type: "Geodome",
      guests: [
        { name: "Lea Hunter and Trevor Keough", photo: "photos/lea-trevor.png" },
      ]
    },
    {
      number: 5,
      name: "Red Bud",
      type: "Cabin",
      guests: [
        { name: "Cooper and Bryana Rimkus", photo: "photos/cooper-bryana.png" },
        { name: "Ian Turek and Lauren Wade", photo: "photos/ian-lauren.jpg" },
      ]
    },
    {
      number: 6,
      name: "Lockhart",
      type: "Geodome",
      guests: [
        { name: "Chico Chingaya and Heather Chingaya", photo: "photos/heather-chico.png" },
      ]
    },
    {
      number: 7,
      name: "Marfa",
      type: "Geodome",
      guests: [
        { name: "Mike and Hannah Welsh", photo: "photos/hannah-mike.png" },
        { name: "Obie Puckett and Delwin Campbell", photo: "photos/obie-delwin.jpg" },
      ]
    },
    {
      number: 8,
      name: "Winecup",
      type: "Cabin",
      guests: []
    },
    {
      number: 9,
      name: "Mesquite",
      type: "Cabin",
      guests: [
        { name: "Rachel Dexheimer and Andrew Schneider", photo: "photos/rachel-andrew.png" },
        { name: "Cameron Johnson", photo: "photos/cameron.png" },
        { name: "Landon Henriksen", photo: "photos/landon.png" },
      ]
    },
    {
      number: 10,
      name: "Bandera",
      type: "Geodome",
      guests: []
    },
    {
      number: 11,
      name: "Pecan",
      type: "Cabin",
      guests: [
        { name: "Daniel Baker and Raelynn Spinrod", photo: "photos/daniel-rae.png" },
        { name: "Tom Bank", photo: "photos/tom.png" },
        { name: "Sam Oliver", photo: "photos/sam.png" }
      ]
    },
    {
      number: 12,
      name: "Boerne",
      type: "Geodome",
      guests: [
        { name: "Michael Schantz and Emily Brennan", photo: "photos/michael-emily.jpg" },
      ]
    },
    {
      number: 13,
      name: "Amarillo",
      type: "Geodome",
      guests: [
        { name: "Tyler and Kira Allison", photo: "photos/tyler-kira.jpg" },
      ]
    },
    {
      number: 14,
      name: "Cypress",
      type: "Cabin",
      guests: [
        { name: "Ben Myers and Margret Bilder", photo: "photos/ben-margaret.jpg" },
        { name: "Nyal Gary and Isaac Trautman", photo: "photos/isaac-nyal.png" },
        { name: "Keith Mwangi", photo: "photos/keith.png" },
        { name: "Travis Buholtz", photo: "photos/travis.png" },
      ]
    },
    {
      number: 15,
      name: "Bluebonnet",
      type: "Cabin",
      guests: [
        { name: "Lindsey Poulton and Joe Scuderi", photo: "photos/lindsey-joe.png" },
      ]
    },
    {
      number: 16,
      name: "Primrose",
      type: "Cabin",
      guests: [
        { name: "Darby and Alex Hall", photo: "photos/darby-alex.png" },
      ]
    },
    {
      number: 17,
      name: "Lufkin",
      type: "Geodome",
      guests: [
        { name: "Sam and Dara Simmons", photo: "photos/sam-dara.png" },
      ]
    },
    {
      number: 18,
      name: "Beaumont",
      type: "Geodome",
      guests: [
        { name: "Charlie Mohr and Cassidy Carmichael", photo: "photos/charlie-cass.png" },
      ]
    },
    {
      number: 19,
      name: "Gruene",
      type: "Geodome",
      guests: [
        { name: "Colin and Autumn Tolimer", photo: "photos/colin-autumn.png" },
      ]
    },
    {
      number: 20,
      name: "Jefferson",
      type: "Geodome",
      guests: [
        { name: "Conor Puckett and Brandy Marks", photo: "photos/conor-brandy.png" },
      ]
    },
    {
      number: 21,
      name: "Texas Lantana",
      type: "Cabin",
      guests: [
        { name: "Tyler and Courtney Macdonald", photo: "photos/tyler-courtney.png" },
      ]
    },
    {
      number: 22,
      name: "Eco Yurt",
      type: "Yurt",
      guests: [
        { name: "Mason Puckett and Sarah Matlock", photo: "photos/mason-sarah.png" },
      ]
    },
    {
      number: 23,
      name: "Wimberley",
      type: "Geodome",
      guests: [
        { name: "Pete and Hilary Puckett", photo: "photos/pete-hilary.png" },
      ]
    }
  ];

  const listEl         = document.getElementById("cabins-list");
  const selectedNameEl = document.getElementById("selected-cabin-name");
  const selectedTypeEl = document.getElementById("selected-cabin-type");
  const detailsBoxEl   = document.getElementById("details-box");
  const guestNamesEl   = detailsBoxEl.querySelector(".guest-names");

  const mapImg         = document.getElementById("mapImage");
  const panelEl        = document.querySelector(".panel");
  const panelToggleBtn = document.getElementById("panelToggle");
  const panelBackdrop  = document.getElementById("panelBackdrop");
const panelCloseBtn  = document.getElementById("panelClose");

  const lightboxEl        = document.getElementById("photoLightbox");
  const lightboxImgEl     = document.getElementById("lightboxImage");
  const lightboxCaptionEl = document.getElementById("lightboxCaption");

  let photoWrapperEl = document.getElementById("guest-photo-wrapper");
  if (!photoWrapperEl) {
    photoWrapperEl = document.createElement("div");
    photoWrapperEl.id = "guest-photo-wrapper";
    photoWrapperEl.className = "guest-photo-wrapper";
    detailsBoxEl.appendChild(photoWrapperEl);
  }

  const guests = cabins.flatMap((cabin, cabinIndex) => {
    if (!Array.isArray(cabin.guests) || cabin.guests.length === 0) return [];
    return cabin.guests.map(guest => ({
      guestName: guest.name,
      photo: guest.photo || "",
      cabinName: cabin.name,
      number: cabin.number,
      type: cabin.type,
      cabinIndex
    }));
  });

  function renderGuests() {
    guests.forEach((g, index) => {
      const li = document.createElement("li");
      li.className = "cabin-item";

      const button = document.createElement("button");
      button.type = "button";
      button.setAttribute("data-guest-index", index);

      const nameSpan = document.createElement("span");
      nameSpan.className = "cabin-name";
      nameSpan.textContent = g.guestName;

      button.appendChild(nameSpan);
      li.appendChild(button);
      listEl.appendChild(li);
    });
  }

  function openPanel() {
    if (panelEl) panelEl.classList.add("panel-open");
    if (panelBackdrop) panelBackdrop.style.display = "block";
  }

  function closePanel() {
    if (panelEl) panelEl.classList.remove("panel-open");
    if (panelBackdrop) panelBackdrop.style.display = "none";
  }

  function openLightbox(src, caption) {
    if (!lightboxEl || !lightboxImgEl) return;
    lightboxImgEl.src = src || "";
    lightboxImgEl.alt = caption || "";
    if (lightboxCaptionEl) {
      lightboxCaptionEl.textContent = caption || "";
    }
    lightboxEl.classList.add("open");
    lightboxEl.setAttribute("aria-hidden", "false");
  }

  function closeLightbox() {
    if (!lightboxEl || !lightboxImgEl) return;
    lightboxEl.classList.remove("open");
    lightboxEl.setAttribute("aria-hidden", "true");
    lightboxImgEl.src = "";
    lightboxImgEl.alt = "";
    if (lightboxCaptionEl) {
      lightboxCaptionEl.textContent = "";
    }
  }

  if (lightboxEl) {
    lightboxEl.addEventListener("click", (event) => {
      const isBackdrop = event.target.classList.contains("photo-lightbox-backdrop");
      const isCloseBtn = event.target.classList.contains("photo-lightbox-close");
      if (isBackdrop || isCloseBtn) {
        closeLightbox();
      }
    });
  }

  document.addEventListener("keydown", (event) => {
    if (event.key === "Escape") {
      closeLightbox();
    }
  });

  if (panelToggleBtn) {
  panelToggleBtn.addEventListener("click", () => {
    const isOpen = panelEl && panelEl.classList.contains("panel-open");
    if (isOpen) {
      closePanel();
    } else {
      openPanel();
    }
  });
}

if (panelBackdrop) {
  panelBackdrop.addEventListener("click", closePanel);
}

if (panelCloseBtn) {
  panelCloseBtn.addEventListener("click", closePanel);
}

  function selectCabin(cabinIndex) {
    const cabin = cabins[cabinIndex];
    if (!cabin) return;

    const cabinGuests = Array.isArray(cabin.guests) ? cabin.guests : [];
    const hasGuests = cabinGuests.length > 0;

    if (hasGuests) {
      selectedNameEl.textContent = cabinGuests.map(g => g.name).join(", ");
      selectedTypeEl.textContent = "";

      guestNamesEl.classList.remove("empty");
      guestNamesEl.textContent = `#${cabin.number} · ${cabin.name} (${cabin.type || "Lodging"})`;

      photoWrapperEl.innerHTML = "";
      cabinGuests.forEach(g => {
        if (g.photo) {
          const img = document.createElement("img");
          img.className = "guest-photo";
          img.src = g.photo;
          img.alt = g.name;
          img.loading = "lazy";

          img.addEventListener("click", () => {
            const caption = `${g.name} – #${cabin.number} · ${cabin.name} (${cabin.type || "Lodging"})`;
            openLightbox(g.photo, caption);
          });

          photoWrapperEl.appendChild(img);
        }
      });

    } else {
      selectedNameEl.textContent = cabin.name;
      selectedTypeEl.textContent = cabin.type || "";
      guestNamesEl.classList.add("empty");
      guestNamesEl.textContent = `#${cabin.number} · ${cabin.name} (${cabin.type || "Lodging"}) – no guests assigned`;
      photoWrapperEl.innerHTML = "";
    }

    document.querySelectorAll(".cabin-item button").forEach(btn => {
      const gi = Number(btn.getAttribute("data-guest-index"));
      const guestEntry = guests[gi];
      const isActive = guestEntry && guestEntry.cabinIndex === cabinIndex;
      btn.classList.toggle("active", isActive);
    });

    document.querySelectorAll(".hotspot").forEach(btn => {
      const name = btn.getAttribute("data-cabin");
      const isThisCabin = name === cabin.name;
      btn.classList.toggle("active-hotspot", isThisCabin);
    });

    if (window.innerWidth <= 800) {
      openPanel();
    }
  }

  listEl.addEventListener("click", (event) => {
    const button = event.target.closest("button[data-guest-index]");
    if (!button) return;
    const guestIndex = Number(button.getAttribute("data-guest-index"));
    const guest = guests[guestIndex];
    if (!guest) return;
    selectCabin(guest.cabinIndex);
  });

  function wireHotspots() {
    document.querySelectorAll(".hotspot").forEach(btn => {
      btn.addEventListener("click", () => {
        const cabinName = btn.getAttribute("data-cabin");
        const cabinIndex = cabins.findIndex(c => c.name === cabinName);
        if (cabinIndex === -1) return;
        selectCabin(cabinIndex);
      });
    });
  }

  if (mapImg) {
    mapImg.addEventListener("click", (event) => {
      const rect = mapImg.getBoundingClientRect();
      const xPercent = ((event.clientX - rect.left) / rect.width * 100).toFixed(1);
      const yPercent = ((event.clientY - rect.top) / rect.height * 100).toFixed(1);
      console.log(`Clicked at left: ${xPercent}%; top: ${yPercent}%;`);
    });
  }

  renderGuests();
  wireHotspots();
  </script>
</body>

</html>



